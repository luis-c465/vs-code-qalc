{
    "scopeName": "source.qalc",
    "patterns": [
        {
            "include": "#expression"
        }
    ],
    "repository": {
        "expression": {
            "patterns": [
                {
                    "include": "#reassignUnitError"
                },
                {
                    "include": "#keywords"
                },
                {
                    "include": "#constants"
                },
                {
                    "include": "#mathjsConstants"
                },
                {
                    "include": "#variableAssignment"
                },
                {
                    "include": "#function"
                },
                {
                    "include": "#comment"
                },
                {
                    "include": "#header"
                },
                {
                    "include": "#symbols"
                },
                {
                    "include": "#symbolsOnlyNotAfterANumber"
                },
                {
                    "include": "#symbolsOnlyNotBeforeANumber"
                },
                {
                    "include": "#symbolsNotInScientificNotation"
                },
                {
                    "include": "#binary"
                },
                {
                    "include": "#octal"
                },
                {
                    "include": "#hex"
                }
                
            ]
        },
        "keywords" :{
            "match": "\\b(in|to|last|off|of|mod|xor|or|ago)\\b",
            "captures": {
                "1": {
                    "name": "entity.name.type"
                }
            }
        },
        "constants" :{
            "match": "\\b(today|tomorrow|now|time|yesterday|sum|total|average|avg)\\b",
            "captures": {
                "1": {
                    "name": "variable"
                }
            }
        },
        "mathjsConstants": {
            "match": "\\b(speedOfLight|gravitationConstant|planckConstant|reducedPlanckConstant|magneticConstant|electricConstant|vacuumImpedance|coulomb|elementaryCharge|bohrMagneton|conductanceQuantum|inverseConductanceQuantum|magneticFluxQuantum|nuclearMagneton|klitzing|bohrRadius|classicalElectronRadius|electronMass|fermiCoupling|fineStructure|hartreeEnergy|protonMass|deuteronMass|neutronMass|quantumOfCirculation|rydberg|thomsonCrossSection|weakMixingAngle|efimovFactor|atomicMass|avogadro|boltzmann|faraday|firstRadiation|loschmidt|gasConstant|molarPlanckConstant|molarVolume|sackurTetrode|secondRadiation|stefanBoltzmann|wienDisplacement|molarMass|molarMassC12|gravity|atm|planckLength|planckMass|planckTime|planckCharge|planckTemperature|e|E|i|Infinity|LN2|LN10|LOG2E|LOG10E|NaN|null|phi|pi|PI|SQRT1_2|SQRT2|tau|undefined|version)\\b",
            "captures": {
                "1": {
                    "name": "variable"
                }
            }
        },
        "variableAssignment": {
            "match": "^\\s*(\\w+)(?=\\s*\\=)",
            "captures": {
                "1": {
                    "name": "constant.numeric"
                }
            }
        },
        "function": {
            "begin": "(\\w+)(\\()",
            "end": "(\\))",
            "beginCaptures": {
                "1": {
                    "name": "entity.name.function"
                },
                "2": {
                    "name": "punctuation"
                }
            },
            "endCaptures": {
                "1": {
                    "name": "punctuation"
                }
            },
            "patterns": [
                {
                    "include": "#expression"
                }
            ]
        },
        "comment": {
            "match": "//.*$",
            "name": "comment"
        },
        "header": {
            "match": "^\\s*#.*$",
            "name": "string"
        },
        "symbols": {
            "match": "[\\+\\/\\*\\|\\^\\&\\>\\<\\(\\)\\[\\]\\!\\=\\'\\\"\\:\\?]",
            "name": "punctuation"
        },
        "symbolsOnlyNotAfterANumber": {
            "match": "(?<!\\d)[\\%]",
            "name": "punctuation"
        },
        "symbolsOnlyNotBeforeANumber": {
            "match": "[\\,\\.](?!\\d)",
            "name": "punctuation"
        },
        "symbolsNotInScientificNotation": {
            "match": "(?<!\\de)\\-",
            "name": "punctuation"
        },
        "binary": {
            "match": "(?<=\\b)0b(?=[01])",
            "name": "punctuation"
        },
        "octal": {
            "match": "(?<=\\b)0o(?=[0-7])",
            "name": "punctuation"
        },
        "hex": {
            "match": "(?<=\\b)0x(?=[0-9a-fA-F])",
            "name": "punctuation"
        },
        "reassignUnitError": {
            "match": "^\\s*(atto|a|centi|c|deca|da|deci|d|exa|E|exi|Ei|femto|f|gibi|Gi|giga|G|hecto|h|kibi|Ki|kilo|k|mebi|Mi|mega|M|micro|u|milli|m|nano|n|pebi|Pi|peta|P|pico|p|tebi|Ti|tera|T|yobi|Yi|yocto|y|yotta|Y|zebi|Zi|zepto|z|zetta|Z)?(meter|m|inch|in|foot|feet|ft|yard|yd|mile|mi|link|li|rod|rd|chain|ch|angstrom|mil|m2|sqin|sqft|sqyd|sqmi|sqrd|sqch|sqmil|acre|hectare|m3|litre|l|L|lt|liter|cc|cuin|cuft|cuyd|teaspoon|tablespoon|minim|min|fluiddram|fldr|fluidounce|floz|gill|gi|cup|cp|pint|pt|quart|qt|gallon|gal|beerbarrel|bbl|oilbarrel|obl|hogshead|drop|gtt|rad|radian|deg|degree|grad|gradian|cycle|arcsec|arcsecond|arcmin|arcminute|second|s|sec|minute|min|hour|h|hr|day|week|month|year|decade|century|centuries|millennium|millennia|hertz|Hz|gram|g|tonne|ton|grain|gr|dram|dr|ounce|oz|poundmass|lbm|lb|lbs|hundredweight|cwt|stick|stone|ampere|A|kelvin|K|celsius|degC|fahrenheit|degF|rankine|degR|mole|mol|candela|cd|newton|N|dyne|dyn|poundforce|lbf|kip|joule|J|erg|Wh|BTU|electronvolt|eV|watt|W|hp|Pa|psi|atm|torr|bar|mmHg|mmH2O|cmH2O|ampere|A|coulomb|C|watt|W|volt|V|ohm|farad|F|weber|Wb|tesla|T|henry|H|siemens|S|electronvolt|eV|bits|b|bytes|B|CAD|HKD|ISK|PHP|DKK|HUF|CZK|GBP|RON|SEK|IDR|INR|BRL|RUB|HRK|JPY|THB|CHF|EUR|MYR|BGN|TRY|CNY|NOK|NZD|ZAR|USD|MXN|SGD|AUD|ILS|KRW|PLN|USD|px|pixel|pixels|pt|point|points|em|oF|oC)s?\\s*=.*",
            "name": "support.function"
        }
    }
}